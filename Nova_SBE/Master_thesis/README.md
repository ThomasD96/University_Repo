# Credit Risk Modeling  Prediciting Customer Loan Defaults with Machine Learning Models
### Master-thesis @ NovaSBE, Academic year 2021/22
### In co-operation with zeb.rolfes.schierenböck.associates gmbh

<p align="center">
  <img width="460" height="300" src="data:image/png;base64,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/460/300">
</p>

> **Author**: Thomas Dornigg
> > **Supervisor**: Prof. João Pedro Pereira

## Overview
Many people struggle to get loans due to insufficient or non-existent credit histories. And, unfortunately, this population is often taken advantage of by untrustworthy lenders. Companies like Home Credit strives to broaden financial inclusion for the unbanked population by providing a positive and safe borrowing experience. In order to make sure this underserved population has a positive loan experience, Home Credit makes use of a variety of alternative data (e.g., including telco and transactional information) to predict their clients' repayment abilities. By using various Statistical, Machine Learning  and Deep learning methods we unlock the full potential of their data. Doing so will ensure that clients capable of repayment are not rejected and that loans are given with a principal, maturity, and repayment calendar that will empower their clients to be successful. 

The objective of this project is to use historical loan application data to predict whether or not an applicant will be able to repay a loan. This is a standard supervised classification task:

- Supervised: The labels are included in the training data and the goal is to train a model to learn to predict the labels from the features

- Classification: The label is a binary variable, 0 (will repay loan on time), 1 (will have difficulty repaying loan)

In this project, the goals achieved are :
- Data Exploration routines are designed and implemented to do Statistical analysis and Visualization.
- Classification models such as Naïve Bayes, Logistic Regression, Support Vector machine (SVM), Decision Tree, Random Forest, Gradient Boosting Machine (GBM) and Deep Learning are built to predict whether or not an applicant will be able to repay a loan. 
- Evaluated Classification models by Accuracy, Confusion Matrix, Precision, Recall, True Negative Rate (TNR), False Discovery Rate (FDR), Gain Chart, Lift Chart, K-S Chart, ROC – AUC chart.
- Deployed the Final solution as a Web application (Restful API).

## Data Sources
The data is provided by Home Credit, a service dedicated to provided lines of credit (loans) to the unbanked population. Predicting whether or not a client will repay a loan or have difficulty is a critical business need, and Home Credit wants to unlock the full potential of their data to see what sort of machine learning/deep learning models can be develop to help them in this task.

## Data Exploration
Data Exploration is an open-ended process where we calculate statistics and make figures to find trends, anomalies, patterns, or relationships within the data. The goal of Data Exploration is to learn what our data can tell us. It generally starts out with a high level overview, then narrows in to specific areas as we find intriguing areas of the data. The findings may be interesting in their own right, or they can be used to inform our modeling choices, such as by helping us decide which features to use.

We use Label Encoding for any categorical variables with only 2 categories and One-Hot Encoding for any categorical variables with more than 2 categories.

### Most Valuable Plot (MVP) – Combination Charts
We do statistical analysis and visualization for both numeric and categorical variables. We generate descriptive statistics that summarize the central tendency, dispersion and shape of a data’s distribution. 

For numeric variables, we plot histograms to show the distribution of the numerical variable with one y-axis which is for count of the values in the numeric variable and also plot line graph with another y-axis which for the percent of Target=1 (will have difficulty repaying loan).

For categorical variables, we plot bar chart to show the distribution of the categorical variable and sort in decreasing order with one y-axis which is for count of the values for the categories and also plot line graph with another y-axis which for the percent of Target=1 (will have difficulty repaying loan). 

This plot is called the Most Valuable Plot (MVP), also called Combination Chart. The combination chart is the best visualization method to demonstrate the predictability power of a predictor (X-axis) against a target (Y-axis). They show us how the variable affecting the percent of Target=1, thereby demonstrate the predictability power of a variable for our predictive modeling. From the visual, we can say that as the count of the variable is increasing/decreasing, the percent of Target=1 is decreasing or increasing depending on the steepness of the line, so the loan are repaid more or less depending the percent decrease or increase respectively.

## Data Modeling 
We use the following Machine learning algorithms and built Classification models for our supervised classification task.
### 1)	Naïve Bayes
### 2)	Logistic Regression
### 3)	Decision Tree
### 4)	Random Forest
### 5)	Gradient Boosting Machine (GBM)
### 6)	Deep Learning

Out of the above, the first four are Baseline models and last three are improved models.

## Model Evaluation 

Evaluated Classification models by Accuracy, Confusion Matrix, Precision, Recall, True Negative Rate (TNR), False Discovery Rate (FDR), Gain Chart, Lift Chart, K-S Chart, ROC – AUC chart.

After comparing the performance of above technique Gradient Boosting machine(GBM) performs the best followed by the Deep Learning neural network classifier followed by Random Forest.
